@startuml CreateGrammarQuestion

actor User
participant "GrammarQuestionServiceImpl" as GQS
participant "GrammarQuestionRepository" as GQR
participant "BaseServiceImpl" as BSI

== Create Grammar Question ==
User -> GQS: create(dto)
activate GQS

GQS -> GQS: Check if serial is unique
alt Serial not unique
    GQS --> User: Throw DataIntegrityViolationException
    deactivate GQS
else Serial unique
    GQS -> BSI: Call super.create(dto)
    note right: Gọi hàm create từ BaseServiceImpl
    BSI -> GQS: Call convertToEntity(dto)
    note right: convertToEntity được định nghĩa trong BaseServiceImpl\nvà triển khai trong GrammarQuestionServiceImpl
    GQS --> BSI: GrammarQuestion entity

    BSI -> GQR: Save GrammarQuestion entity
    activate GQR
    GQR --> BSI: Saved GrammarQuestion entity
    deactivate GQR

    BSI -> GQS: Call convertToDTO(saved entity)
    GQS --> BSI: GrammarQuestionDTO
end

GQS --> User: Return GrammarQuestionDTO
deactivate GQS

@enduml
