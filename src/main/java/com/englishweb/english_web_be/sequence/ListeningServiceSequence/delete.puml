@startuml DeleteListening

actor User
participant "ListeningServiceImpl" as LS
participant "ListeningQuestionServiceImpl" as LQS
participant "ListenAndWriteAWordServiceImpl" as LAW
participant "BaseServiceImpl" as BSI
participant "ListeningRepository" as LR

== Delete Listening ==
User -> LS: delete(id)
activate LS

LS -> LS: isExist(id)

LS -> LQS: Find all questions by listeningId
activate LQS
LQS --> LS: List of ListeningQuestionDTO
deactivate LQS

loop Delete all related questions
    LS -> LQS: delete(questionId)
end

LS -> LAW: Find all words by listeningId
activate LAW
LAW --> LS: List of ListenAndWriteAWordDTO
deactivate LAW

loop Delete all related words
    LS -> LAW: delete(listenAndWriteId)
end

LS -> BSI: Call super.delete(id)
note right: Gọi hàm delete từ BaseServiceImpl
BSI -> LR: Delete Listening by ID
activate LR
LR --> BSI: Entity deleted
deactivate LR

BSI --> LS: Confirm deletion
LS --> User: Confirm deletion
deactivate LS

@enduml
