@startuml FindWithPagingSortingSearching

actor User
participant "ListeningServiceImpl" as LS
participant "ValidationUtils" as VU
participant "LessonSpecification" as LES
participant "ListeningRepository" as LR
participant "BaseServiceImpl" as BSI

== Find Listening Page ==
User -> LS: findWithPagingSortingSearching(title, status, page, size, sortBy, sortDir, dtoClass)
activate LS

LS -> VU: Validate page request parameters
activate VU
VU --> LS: Validation complete
deactivate VU

LS -> LES: Create Specification for title
activate LES
LES --> LS: Specification for title
deactivate LES

LS -> LES: Create Specification for status
activate LES
LES --> LS: Specification for status
deactivate LES

LS -> LR: Find all Listening with Specification and Paging
activate LR
LR --> LS: Page of Listening entities
deactivate LR

loop Convert each entity to DTO
    LS -> BSI: Call super.convertToDTO(entity)
    note right: convertToDTO được định nghĩa trong BaseServiceImpl\nvà triển khai trong ListeningServiceImpl
end

LS --> User: Return Page of ListeningDTO
deactivate LS

@enduml
