@startuml ScoreWritingSequence
actor User
participant "ScoreWritingServiceImpl" as SWS
participant "TextRazorServiceImpl" as TRS
participant "GeminiClientService" as GCS
participant "ObjectMapper" as OM

== Scoring Writing Process ==
User -> SWS: 1. Request scoreWriting (text, topic)
activate SWS

SWS -> TRS: 1.1 Analyze text using TextRazor
activate TRS
TRS --> SWS: 1.2 AnalyzedText result
deactivate TRS

SWS -> SWS: 1.3 Build prompt for scoring

SWS -> GCS: 1.4 Generate text based on prompt
activate GCS
GCS --> SWS: 1.5 Generated response
deactivate GCS

SWS -> SWS: 1.6 Extract JSON from response

SWS -> OM: 1.7 Parse response to JSON
activate OM
OM --> SWS: 1.8 Extracted score and comment
deactivate OM

SWS -> User: 2. Return ScoreCommentResponse (score, comment)
deactivate SWS

@enduml
